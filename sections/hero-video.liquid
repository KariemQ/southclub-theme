{% comment %}
  Enhanced Hero Video section with improved scroll functionality and accessibility
{% endcomment %}

{% if section.settings.video != blank or section.settings.video_url != blank %}
<section class="hero-section" data-section-id="{{ section.id }}" id="hero" role="banner" aria-label="Hero video">
  <div class="hero-video__wrapper"
       role="button"
       tabindex="0"
       aria-label="Click to scroll to main content">

    {%- comment -%} Preferred: video uploaded in Settings > Files {%- endcomment -%}
    {% if section.settings.video != blank %}
      {{ section.settings.video | video_tag:
          class: 'hero-video__media',
          autoplay: true,
          loop: true,
          muted: true,
          playsinline: true,
          loading: 'eager'
      }}
    {% else %}
      <video
        class="hero-video__media"
        src="{{ section.settings.video_url }}"
        autoplay
        loop
        muted
        playsinline
        loading="eager"
        aria-label="Background video showcasing {{ shop.name }}">
      </video>
    {% endif %}

    {%- comment -%} Single white scroll arrow (re-used) {%- endcomment -%}
    <button class="hero-video__scroll-down"
            aria-label="Scroll down to main content"
            title="Scroll to explore our products"
            data-scroll-trigger>
      <svg width="28" height="28" viewBox="0 0 24 24" fill="none"
           stroke="currentColor" stroke-width="1.5"
           stroke-linecap="round" stroke-linejoin="round"
           aria-hidden="true">
        <polyline points="6 9 12 15 18 9" />
      </svg>
    </button>
  </div><!-- /.hero-video__wrapper -->
</section>
{% endif %}

<style>
/* ========= Section-specific styles ========= */

.hero-section[data-section-id="{{ section.id }}"] {
  {% if section.settings.overlay_opacity > 0 %}
    position: relative;
  {% endif %}
}

/* Dark overlay option */
{% if section.settings.overlay_opacity > 0 %}
.hero-section[data-section-id="{{ section.id }}"]::before {
  content: '';
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, {{ section.settings.overlay_opacity | divided_by: 100.0 }});
  z-index: 2;
  pointer-events: none;
}

/* Ensure arrow stays above overlay */
.hero-section[data-section-id="{{ section.id }}"] .hero-video__scroll-down {
  z-index: 3;
}
{% endif %}

/* ---------- Arrow positioning (above announcement bar) ---------- */
.hero-video__scroll-down {
  position: absolute;
  bottom: calc(1.25rem + var(--announcement-bar-h, 31px)); /* 1.25rem â‰ˆ 20px gap */
  left: 50%;
  transform: translateX(-50%);
  width: 48px;
  height: 48px;
  border: 2px solid #fff;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.15);
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background 0.25s ease, transform 0.25s ease;
}

/* Hover / focus */
.hero-video__scroll-down:hover,
.hero-video__scroll-down:focus-visible {
  background: rgba(255, 255, 255, 0.25);
  transform: translate(-50%, -3px);
}

/* Smaller size on mobile */
@media (max-width: 749px) {
  .hero-video__scroll-down {
    width: 40px;
    height: 40px;
    bottom: calc(1rem + var(--announcement-bar-h, 31px));
  }
}
</style>

{% schema %}
{
  "name": "Hero Video",
  "settings": [
    {
      "type": "video",
      "id": "video",
      "label": "Background Video",
      "info": "Upload your logo video here. Recommended format: MP4. For best performance, keep file size under 10MB."
    },
    {
      "type": "url",
      "id": "video_url",
      "label": "Or Video URL (MP4)",
      "info": "Alternative: paste a direct link to your video file. Video URL will be ignored if a video file is uploaded above."
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "Video Overlay Opacity",
      "min": 0,
      "max": 80,
      "step": 5,
      "unit": "%",
      "default": 0,
      "info": "Add a dark overlay to improve text readability"
    }
  ],
  "presets": [
    {
      "name": "Hero Video",
      "category": "Video"
    }
  ]
}
{% endschema %}