{% comment %}
  Enhanced Hero Video section with improved scroll functionality and accessibility
{% endcomment %}

{% if section.settings.video != blank or section.settings.video_url != blank %}
<section class="hero-section"
         data-section-id="{{ section.id }}"
         id="hero"
         role="banner"
         aria-label="Hero video">

  <div class="hero-video__wrapper"
       role="button"
       tabindex="0"
       aria-label="Click to scroll to main content">

    {%- comment -%} Preferred: video uploaded in Settings > Files {%- endcomment -%}
    {% if section.settings.video != blank %}
      {{ section.settings.video | video_tag:
          class: 'hero-video__media',
          autoplay: true,
          loop: true,
          muted: true,
          playsinline: true,
          loading: 'eager'
      }}
    {% else %}
      <video class="hero-video__media"
             src="{{ section.settings.video_url }}"
             autoplay
             loop
             muted
             playsinline
             loading="eager"
             aria-label="Background video showcasing {{ shop.name }}">
      </video>
    {% endif %}

    {%- comment -%} Single minimal scroll arrow {%- endcomment -%}
    <button class="hero-video__scroll-down"
            aria-label="Scroll down to main content"
            title="Scroll to explore our products"
            data-scroll-trigger>
      <svg class="arrow-icon" viewBox="0 0 24 24" aria-hidden="true">
        <polyline points="6 9 12 15 18 9" />
      </svg>
    </button>
  </div><!-- /.hero-video__wrapper -->

</section>
{% endif %}

<style>
/* ========== Hero-specific styles ========== */

.hero-section[data-section-id="{{ section.id }}"] {
  {% if section.settings.overlay_opacity > 0 %}
    position: relative;
  {% endif %}
}

/* Optional dark overlay */
{% if section.settings.overlay_opacity > 0 %}
.hero-section[data-section-id="{{ section.id }}"]::before {
  content: '';
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, {{ section.settings.overlay_opacity | divided_by: 100.0 }});
  z-index: 2;
  pointer-events: none;
}
{% endif %}

/* ---------- Minimal scroll arrow ---------- */
.hero-video__scroll-down {
  position: absolute;

  /* header-stack â‰ˆ announcement (31) + nav (60) = 91 px */
  bottom: calc(3rem + var(--announcement-bar-h, 31px) + 60px); /* lift arrow higher */
  left: 50%;
  transform: translateX(-50%);
  width: 32px;
  height: 32px;
  padding: 0;
  border: none;
  background: none;
  color: #fff;
  cursor: pointer;
  transition: transform 0.25s ease, opacity 0.25s ease;
  opacity: 0.85;
  z-index: 11; /* above header overlay */
}

.hero-video__scroll-down:hover,
.hero-video__scroll-down:focus-visible {
  transform: translate(-50%, -4px);
  opacity: 1;
}

/* Chevron icon styling */
.arrow-icon {
  width: 100%;
  height: 100%;
  fill: none;
  stroke: currentColor;
  stroke-width: 1.8;
  stroke-linecap: round;
  stroke-linejoin: round;
}

/* Mobile tweaks */
@media (max-width: 749px) {
  .hero-video__scroll-down {
    width: 28px;
    height: 28px;
    bottom: calc(2rem + var(--announcement-bar-h, 31px) + 60px);
  }
}
</style>

{% schema %}
{
  "name": "Hero Video",
  "settings": [
    {
      "type": "video",
      "id": "video",
      "label": "Background Video",
      "info": "Upload your logo video here. Recommended format: MP4. For best performance, keep file size under 10MB."
    },
    {
      "type": "url",
      "id": "video_url",
      "label": "Or Video URL (MP4)",
      "info": "Alternative: paste a direct link to your video file. Video URL will be ignored if a video file is uploaded above."
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "Video Overlay Opacity",
      "min": 0,
      "max": 80,
      "step": 5,
      "unit": "%",
      "default": 0,
      "info": "Add a dark overlay to improve text readability"
    }
  ],
  "presets": [
    {
      "name": "Hero Video",
      "category": "Video"
    }
  ]
}
{% endschema %}
